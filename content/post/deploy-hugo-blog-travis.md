---
title: "How I use Travis CI to automatically deploy this blog to GitHub Pages"
date: 2019-10-21T20:32:01+01:00
Description: "This Hugo blog is automatically built and deployed to GitHub Pages using Travis CI. This post explains a little about how that works."
Tags: ['hugo','ci','travis','github']
Categories: []
Draft: true
author:
  given_name: Ben
  family_name: Crisp
  display_name: Ben Crisp

---

I host this blog for free with [GitHub Pages](https://pages.github.com/).

Pages integrates with [Jekyll](https://jekyllrb.com/), a popular [static site generator](https://stackoverflow.com/questions/30181349/what-is-a-static-site-generator). When you make changes to your Jekyll site, GitHub automatically generates the public HTML files from the source code in your repository. Simply `git push` and, et voil√†, your site is live!

Jekyll is great, but I prefer [Hugo](https://gohugo.io). Rather than miss out on seamless automatic site deployment, I use [Travis](https://travis-ci.com/), a continuous integration service, to get the same level of automation enjoyed by Jekyll users

I've set this up with two GitHub repositories (although one could use a single repository with multiple branches. I think I'd prefer that and may change it in the future). 

[The first repo](https://github.com/bcrisp4/bcrisp4.github.io) (the *DIST* repo) holds the public HTML files generated by Hugo which are served publicly by GitHub Pages. This is the "GitHub Pages repository", which must be named as `<github_username>.github.io`. The files in the master branch of this repo are automatically served at my GitHub pages URL (although I use a [custom URL](https://help.github.com/en/github/working-with-github-pages/configuring-a-custom-domain-for-your-github-pages-site)).

[The second repo](https://github.com/bcrisp4/thecrisp.io) (the *SRC* repo) holds the source code of the Hugo site (e.g. markdown files, themes and configuration).

When I make a change to my blog in the *SRC* repo (e.g. write a new post) and push it to GitHub, Travis automatically builds the site and deploys it to the *DIST* repo. Here is the `.travis.yml` file for the site:

```yml
install:
  # Install v0.55.6 of Hugo, the same version used for development 
  - wget https://github.com/gohugoio/hugo/releases/download/v0.55.6/hugo_0.55.6_Linux-64bit.deb 
  - sudo dpkg -i hugo_0.55.6_Linux-64bit.deb

script:
  - hugo # Build site

deploy:
  provider: pages
  local_dir: public # Static files generated by Hugo
  repo: bcrisp4/bcrisp4.github.io # GitHub pages repo
  target_branch: master
  fqdn: thecrisp.io # Custom URL
  github_token: $GITHUB_TOKEN
  email: ben@thecrisp.io
  name: "bcrisp4"
  skip_cleanup: true
  on:
    branch: master
```
This file tells Travis how to build and deploy the site.

Firstly, it instructs Travis to install dependencies (in this case just Hugo). 

Next, it runs a "script" to build the site (which here is simply the command `hugo`).

Finally, it deploys the site. Travis has [built-in support](https://docs.travis-ci.com/user/deployment/pages/) for deploying to GitHub Pages. I just need to tell Travis a few things:

1. What files to deploy. In this case, it's just the contents of the "public" directory which is created by Hugo after running the build command. It holds the static HTML files etc. generated by Hugo.

2. The GitHub repository (and the branch) the site should be deployed to (the *DIST* repo)

3. The custom FQDN of the site 

4. A "GitHub token" for authentication. This is generated in the GitHub account settings and added to my Travis account (not stored in the file)

5. The email address and name to be used for the commit

After enabling the *SRC* repo on my Travis dashboard, I can `git push` my changes and the site will be re-built and deployed automatically in 1-2 minutes. 

Pretty neat!


